<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OBOE: AI Lyric Analyzer</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Nanum+Myeongjo:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { background-color: #0A0A0A; color: #E0E0E0; font-family: 'Noto Sans KR', sans-serif; }
        .font-title { font-family: 'Nanum Myeongjo', serif; }
        .card { background-color: rgba(26, 26, 26, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(12px); }
        .chat-bubble { max-width: 85%; padding: 12px 18px; border-radius: 22px; line-height: 1.6; }
        .user-bubble { background-color: #3B82F6; color: white; align-self: flex-end; border-bottom-right-radius: 6px; }
        .ai-bubble { background-color: #334155; color: #E0E0E0; align-self: flex-start; border-bottom-left-radius: 6px; }
        .loading-dots span { width: 8px; height: 8px; margin: 0 3px; background-color: #9CA3AF; border-radius: 50%; display: inline-block; animation: bounce 1.4s infinite ease-in-out both; }
        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); } }
        .suggestion-chip {
            cursor: pointer;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: background-color 0.2s;
        }
        .suggestion-chip:hover { background-color: rgba(255, 255, 255, 0.2); }
    </style>
</head>
<body class="antialiased">
        <div class="content-wrapper">
        <div class="container mx-auto px-4 py-16 md:py-24 max-w-4xl">

            <header class="text-center mb-24 md:mb-32">
                <h1 class="font-title text-4xl md:text-6xl font-bold tracking-widest text-glow fade-in">OBOE</h1>
                <p class="text-gray-400 mt-4 text-lg md:text-xl fade-in fade-in-delay-1">An AI-Powered Analysis of YANG HONG WON's Lyrics</p>
                <p class="text-gray-500 mt-2 text-sm md:text-base fade-in fade-in-delay-2">AI의 시선으로 바라본 가사의 의미와 구조</p>
            </header>
            <div class="flex justify-center my-16 md:my-24 opacity-50 fade-in fade-in-delay-2">
                <img src="images/단콘.jpg" alt="Yang Hong Won concert" class="w-64 h-auto mix-blend-lighten"/>
            </div>

            <section class="mb-24 md:mb-32">
                <div class="text-center max-w-2xl mx-auto">
                    <h2 class="font-title text-2xl md:text-3xl font-semibold mb-4 text-glow fade-in">How AI Understands Poetry</h2>
                    <p class="text-gray-400 leading-relaxed fade-in fade-in-delay-1">
                         양홍원의 가사는 단순한 단어의 나열이 아닌, 복잡한 감정과 은유의 집합체입니다. AI가 이 깊이를 이해하기 위해선, 원본 텍스트를 AI의 언어로 '번역'하는 과정이 필수적입니다. 이 과정은 '전처리'와 '임베딩'이라는 핵심 단계를 거치며, AI가 가사의 숨겨진 맥락을 파악하고 깊이 있는 해석을 생성하는 기반이 됩니다.
                    </p>
                </div>
            </section>
            
            <div class="flex justify-center my-16 md:my-24 opacity-50 fade-in fade-in-delay-2">
                <img src="images/오보에1.jpg" alt="Oboe album art concept" class="w-64 h-auto mix-blend-lighten"/>
            </div>

            <div class="space-y-12 md:space-y-20">
                <div class="card p-6 md:p-8 rounded-xl fade-in fade-in-delay-1">
                    <h3 class="font-title text-xl md:text-2xl font-bold text-purple-300 mb-4">Part 1. 정제 (Preprocessing)</h3>
                    <p class="text-gray-400 mb-6">AI가 가사를 학습하기 전, 날것의 텍스트를 의미 있는 단위로 나누고 정제합니다. 불필요한 노이즈를 제거하고, 핵심 의미를 담은 '조각(Chunk)'으로 분할하는 과정은 AI의 이해도를 높이는 첫걸음입니다.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-black/30 p-4 rounded">
                            <h4 class="font-semibold mb-2 text-gray-300">원본 가사 (Raw Text)</h4>
                             <p class="text-sm text-gray-500 font-mono whitespace-pre-line">흘러가길 피로 
 흘러가길 1로 
 이건 내 첫 이별 
 향수 선물같이 비려 
 포장해 편지를 
 예쁜 꽃 가시로           </p>
                        </div>
                        <div class="bg-black/30 p-4 rounded">
                            <h4 class="font-semibold mb-2 text-gray-300">의미 단위 분할 (Chunking)</h4>
                            <div class="space-y-2">
                                 <p class="text-sm text-gray-400 font-mono border-l-2 border-purple-400 pl-2">Chunk 1: "흘러가길 피로, 흘러가길 1로, 이건 내 첫 이별" </p>
                                 <p class="text-sm text-gray-400 font-mono border-l-2 border-purple-400 pl-2">Chunk 2: "향수 선물같이 비려, 포장해 편지를 예쁜 꽃 가시로" </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card p-6 md:p-8 rounded-xl fade-in fade-in-delay-2">
                    <h3 class="font-title text-xl md:text-2xl font-bold text-teal-300 mb-4">Part 2. 번역 (Embedding)</h3>
                    <p class="text-gray-400 mb-6">정제된 텍스트 조각들은 수많은 차원을 가진 '의미의 공간' 속 벡터(좌표)로 변환됩니다. '이별'과 '상실'은 가까운 곳에, '환희'와 '성취'는 다른 곳에 위치하게 됩니다. 이 과정을 통해 AI는 단어와 문장의 미묘한 의미적 관계를 학습합니다.</p>
                    <div class="p-4 bg-black/30 rounded text-center">
                         <p class="font-mono text-teal-400 text-sm md:text-base">"내 첫 이별"  <span class="text-gray-500 font-sans mx-2">→</span>  [0.012, -0.98, ..., 0.453]</p>
                        <p class="text-xs text-gray-500 mt-2">텍스트가 AI가 이해할 수 있는 고차원 벡터로 변환됩니다.</p>
                    </div>
                </div>
                
                <div class="card p-6 md:p-8 rounded-xl fade-in fade-in-delay-3">
                    <h3 class="font-title text-xl md:text-2xl font-bold text-amber-300 mb-4">Part 3. 해석 (Retrieval & Generation)</h3>
                    <p class="text-gray-400 mb-6">"양홍원의 가사에서 '이별'은 어떻게 표현되나?" 라는 질문에, AI는 벡터 공간에서 질문과 가장 가까운 가사 조각들을 검색(Retrieve)합니다. 그리고 이 조각들을 근거로, 질문에 대한 깊이 있는 답변을 새롭게 생성(Generate)합니다.</p>
                    <div class="p-4 bg-black/30 rounded">
                        <p class="font-semibold text-gray-300">질문: <span class="font-normal text-gray-400">"가사 속 화자는 이별을 어떻게 받아들이고 있나?"</span></p>
                        <hr class="border-gray-700 my-3">
                        <p class="font-semibold text-gray-300">AI의 답변 생성 과정:</p>
                        <p class="text-sm text-amber-400 mt-2 font-mono">1.  <span class="text-gray-500">Retrieve relevant chunks:</span> ["...첫 이별"  , "...선물같이 비려"  , "...예쁜 꽃 가시로"]</p>
                        <p class="text-sm text-amber-400 mt-1 font-mono">2.  <span class="text-gray-500">Generate answer based on context:</span> "화자에게 이별은 피와 같이 고통스럽지만 , 동시에 가시 돋친 꽃으로 포장된 선물처럼 양가적인 감정으로 다가옵니다..."</p>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-center my-16 md:my-24 opacity-50 fade-in fade-in-delay-4">
                <img src="images/오보에.jpg" alt="Oboe album art main" class="w-64 h-auto mix-blend-lighten"/>
            </div>

            <section class="mt-24 md:mt-32">
                <h2 class="font-title text-center text-3xl md:text-4xl font-bold mb-12 md:mb-16 text-glow fade-in">Final Analysis: OBOE</h2>
                
                <div class="space-y-12">
                    <div class="card p-6 md:p-8 rounded-xl fade-in">
                        <h3 class="font-title text-2xl font-bold mb-2">실 (Thread)</h3>
                         <p class="text-gray-500 mb-6">"사실로 엉킨 실로 노를 저어 멀리로" </p>
                        <div class="flex justify-center my-16 md:my-24 opacity-50 fade-in fade-in-delay-2">
                            <img src="images/실.jpg" alt="Tangled thread concept" class="w-64 h-auto mix-blend-lighten"/>
                        </div>
                        <h4 class="font-semibold text-purple-300 mb-2">AI-Generated Interpretation:</h4>
                        <p class="text-gray-300 leading-relaxed">
                            '실'은 화자의 복잡한 내면과 관계의 얽힘을 상징합니다. 가사에서 '실'은 '사실'과 발음의 유사성을 통해 진실과 거짓, 현실과 환상이 뒤엉킨 상태를 암시합니다.  화자는 이 엉킨 실, 즉 혼란스러운 현실을 노 삼아 미지의 세계로 나아가려 합니다. 이는 과거로부터의 탈출이자, 고통스러운 진실을 동력으로 삼아 나아가려는 처절한 의지의 표현으로 해석됩니다.  '첫 이별'과 '피'의 이미지는 이 과정이 순탄치 않은, 상처로 가득한 여정임을 보여줍니다.
                        </p>
                    </div>

                    <div class="card p-6 md:p-8 rounded-xl fade-in">
                        <h3 class="font-title text-2xl font-bold mb-2">가면무도회 (Masquerade)</h3>
                         <p class="text-gray-500 mb-6">"나 혼자 가면무도회, 그 미소마저 함부로 해" </p>
                        <div class="flex justify-center my-16 md:my-24 opacity-50 fade-in fade-in-delay-4">
                            <img src="images/가면무도회.jpg" alt="Masquerade mask concept" class="w-64 h-auto mix-blend-lighten"/>
                        </div>
                        <h4 class="font-semibold text-teal-300 mb-2">AI-Generated Interpretation:</h4>
                        <p class="text-gray-300 leading-relaxed">
                            '가면무도회'는 도시의 화려함 속에서 느끼는 개인의 소외와 정체성 혼란을 그립니다.  'Too much city lights'는 외부의 자극이 너무 강해 오히려 자신의 내면을 보지 못하는 상태를 의미합니다.  화자는 수많은 군중 속에서 가면을 쓴 채 홀로 춤을 추고 있으며, 심지어 자신의 '미소'마저 진심이 아닌 연기의 일부가 되어버렸습니다.  이는 타인과의 관계뿐만 아니라 자기 자신과도 단절된 현대인의 깊은 고독과, 진짜 자신을 잃어버린 것에 대한 공허함을 상징합니다.
                        </p>
                    </div>
                </div>
            </section>

        </div>
    </div>
    <div class="container mx-auto px-4 py-16 md:py-24 max-w-5xl">

        <main>
            <div class="card p-6 md:p-8 rounded-xl flex flex-col">
                <h3 class="font-title text-2xl font-bold mb-4 text-teal-300">AI에게 분석 물어보기</h3>
                
                <div id="chat-window" class="flex-1 h-96 overflow-y-auto mb-4 p-3 flex flex-col space-y-4">
                    <div class="chat-bubble ai-bubble">안녕하세요! 저는 양홍원의 '오보에' 앨범 분석 문서를 학습한 AI 평론가입니다. 앨범의 서사, 가사의 중의적 의미, 팬들의 해석 등 무엇이든 물어보세요.</div>
                </div>

                <div id="suggestion-area" class="flex flex-wrap gap-2 mb-4">
                    <div class="suggestion-chip text-sm py-1 px-3 rounded-full">앨범의 전체적인 주제가 뭐야?</div>
                    <div class="suggestion-chip text-sm py-1 px-3 rounded-full">'3보 전진 2보 후퇴'의 의미는?</div>
                    <div class="suggestion-chip text-sm py-1 px-3 rounded-full">타이틀곡 '사계' 가사 해석해줘</div>
                </div>

                <div id="loading-indicator" class="hidden my-2 pl-2">
                    <div class="chat-bubble ai-bubble loading-dots"><span></span><span></span><span></span></div>
                </div>

                <form id="chat-form" class="flex space-x-3">
                    <input type="text" id="chat-input" placeholder="앨범에 대해 질문해보세요..." class="flex-1 bg-gray-800 border border-gray-600 rounded-full px-5 py-2.5 focus:outline-none focus:ring-2 focus:ring-teal-400 text-white transition-all">
                    <button type="submit" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-6 rounded-full transition-colors">전송</button>
                </form>
            </div>
        </main>

        <footer class="text-center mt-16 pt-8 border-t border-white/10">
            <p class="text-gray-600">AI-Powered Lyric Analysis Project based on RAG.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const chatForm = document.getElementById('chat-form');
            const chatInput = document.getElementById('chat-input');
            const chatWindow = document.getElementById('chat-window');
            const loadingIndicator = document.getElementById('loading-indicator');
            const suggestionArea = document.getElementById('suggestion-area');

            const appendMessage = (text, sender) => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `chat-bubble ${sender === 'user' ? 'user-bubble' : 'ai-bubble'}`;
                // 텍스트의 줄바꿈을 <br> 태그로 변환하여 HTML에 렌더링
                messageDiv.innerHTML = text.replace(/\n/g, '<br>');
                chatWindow.appendChild(messageDiv);
                chatWindow.scrollTop = chatWindow.scrollHeight;
            };

            const askQuestion = async (question) => {
                if (!question) return;

                appendMessage(question, 'user');
                chatInput.value = '';
                loadingIndicator.style.display = 'block';
                suggestionArea.style.display = 'none'; // 질문 후 추천 질문 숨기기

                try {
                    const response = await fetch('http://127.0.0.1:5000/ask', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ question })
                    });

                    if (!response.ok) {
                        const errData = await response.json();
                        throw new Error(errData.error || '서버 응답 오류');
                    }

                    const data = await response.json();
                    appendMessage(data.answer, 'ai');
                } catch (error) {
                    appendMessage(`죄송합니다, 오류가 발생했습니다: ${error.message}`, 'ai');
                } finally {
                    loadingIndicator.style.display = 'none';
                }
            };
            
            chatForm.addEventListener('submit', (e) => {
                e.preventDefault();
                askQuestion(chatInput.value.trim());
            });

            suggestionArea.addEventListener('click', (e) => {
                if (e.target.classList.contains('suggestion-chip')) {
                    const question = e.target.textContent;
                    chatInput.value = question;
                    askQuestion(question);
                }
            });
        });
    </script>
</body>
</html>